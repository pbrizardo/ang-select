!function(){"use strict";angular.module("angSelect",[]).directive("angSelectList",[function(){return{restrict:"E",scope:!0,transclude:!0,link:function(e,t){t.on("click",function(e){e.stopPropagation()})}}}]).directive("angSelect",["$document","$timeout",function(e,t){var l=[];return{restrict:"E",scope:{model:"=",data:"=",disabled:"=?",error:"=?",onChange:"&?"},template:function(e,t){var l=t.field?"{{item."+t.field+"}}":"{{item}}";return'<ang-select-display class="ang-select-display" style="display:block"><span>{{selectionDisplay}}</span></ang-select-display><ang-select-list class="ang-select-list" style="display:none; width:100%; position:absolute; top:100%; left:0;" ng-transclude><ang-select-list-item class="ang-select-list-item" style="display:block" ng-repeat="item in list" ng-click="select($index, $event)"><span>'+l+"</span></ang-select-list-item></ang-select-list>"},link:function(e,s,i){function n(){if(e.selectionDisplay=m,s.addClass("ang-select"),g){s.addClass("multiple"),f.select=u,e.multiSelectMap=[];for(var t=0;t<e.list.length;t++)e.multiSelectMap.push(!1);p()}else{f.select=r;var l=-1,n=i.trackby;if(e.model){for(var t=0;t<e.list.length;t++)if(n){if(e.model[n]===e.list[t][n]){l=t;break}}else if(Object.is(e.model,e.list[t])){l=t;break}-1===l&&(e.model=void 0)}d(l)}}function a(){e.list=angular.copy(e.data)}function o(){s.toggleClass("active"),s.find("ang-select-list")[0].style.display=s.hasClass("active")?"block":"none"}function c(){s.removeClass("active"),s.find("ang-select-list")[0].style.display="none"}function r(t){e.model=e.list[t],e.selectionDisplay=y?e.list[t][y]:e.list[t],c(),d(t)}function d(t){e.selectionDisplay=t>-1&&e.list[t]?y?e.list[t][y]:e.list[t]:m}function u(t,l){e.multiSelectMap[t]=!e.multiSelectMap[t],angular.element(l.srcElement).toggleClass("selected"),p()}function p(){for(var t="",l=0,s=[],n=0;n<e.list.length;n++)e.multiSelectMap[n]&&(s.push(e.list[n]),l++,t.length&&(t+=","),t+=y?e.list[n][y]:e.list[n]);l>1&&i.hasOwnProperty("group")?t=l+" Selected":m&&0===l&&(t=m),e.model=s,e.selectionDisplay=t}s[0].style.display="block",s[0].style.position="relative",l.push(s);var f={},g=i.hasOwnProperty("multiple"),m=i.placeholder,y=i.field?i.field:"";i.hasOwnProperty("error")&&e.$watch(function(){return e.error},function(t){e.disabled||(t?s.addClass("error"):s.removeClass("error"))}),i.hasOwnProperty("disabled")&&e.$watch(function(){return e.disabled},function(t){t?(s.addClass("disabled").removeClass("error"),e.error=!1):s.removeClass("disabled")}),e.$watch(function(){return e.data},function(){a(),n()}),e.select=function(l,s){f.select(l,s),"function"==typeof e.onChange&&t(function(){e.onChange()})},s.on("click",function(t){if(t.stopPropagation(),!s.hasClass("disabled")){for(var i=0,n=l.length;n>i;i++)l[i]!==s&&(l[i].removeClass("active"),l[i].find("ang-select-list")[0].style.display="none");o(),s.removeClass("error"),e.error=!1}}),angular.element(document).find("body").on("click",function(){c()})}}}])}();
